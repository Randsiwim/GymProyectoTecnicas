@page "/clases"
@inject ClaseService ClaseService
@inject NavigationManager NavigationManager

<h3>Gestión de Clases</h3>

<table class="table">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Horario</th>
            <th>Entrenador Asignado</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var clase in listaClases)
        {
            <tr @onclick="() => SeleccionarClase(clase)" class="@GetRowClass(clase)" style="cursor:pointer;">
                <td>@clase.Nombre</td>
                <td>@clase.Horario.ToString("dd/MM/yyyy hh:mm tt")</td>
                <td>@clase.EntrenadorID</td>
            </tr>
        }
    </tbody>
</table>

<button class="btn btn-primary" @onclick="ReservarClase">Reservar Clase</button>
<button class="btn btn-secondary" @onclick="VerReservas">Ver Reservas</button>

@code {
    private List<ClaseViewModel> listaClases = new();
    private ClaseViewModel claseSeleccionada;

    protected override async Task OnInitializedAsync()
    {
        listaClases = await ClaseService.GetClasesAsync();
    }

    private void SeleccionarClase(ClaseViewModel clase)
    {
        claseSeleccionada = clase;
    }

    private string GetRowClass(ClaseViewModel clase)
    {
        return clase == claseSeleccionada ? "table-active" : string.Empty;
    }

    private void ReservarClase()
    {
        if (claseSeleccionada != null)
        {
            Console.WriteLine($"Clase '{claseSeleccionada.Nombre}' reservada correctamente.");
        }
        else
        {
            Console.WriteLine("Seleccione una clase para reservar.");
        }
    }

    private void VerReservas()
    {
        NavigationManager.NavigateTo("/reservas");
    }
}

